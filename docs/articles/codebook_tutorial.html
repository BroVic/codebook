<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Codebook tutorial • codebook</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Codebook tutorial">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">codebook</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/codebook.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/codebook_qualtrics.html">Codebook example with Qualtrics dataset</a>
    </li>
    <li>
      <a href="../articles/codebook_sav.html">Codebook example with SPSS dataset</a>
    </li>
    <li>
      <a href="../articles/codebook_tutorial.html">Codebook tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rubenarslan/codebook">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><link href="codebook_tutorial_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="codebook_tutorial_files/pagedtable-1.1/js/pagedtable.js"></script><script src="codebook_tutorial_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="codebook_tutorial_files/jquery-1.12.4/jquery.min.js"></script><link href="codebook_tutorial_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="codebook_tutorial_files/datatables-binding-0.5/datatables.js"></script><link href="codebook_tutorial_files/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="codebook_tutorial_files/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="codebook_tutorial_files/dt-core-1.10.16/js/jquery.dataTables.min.js"></script><script src="codebook_tutorial_files/jszip-1.10.16/jszip.min.js"></script><script src="codebook_tutorial_files/pdfmake-1.10.16/pdfmake.min.js"></script><script src="codebook_tutorial_files/pdfmake-1.10.16/vfs_fonts.js"></script><link href="codebook_tutorial_files/dt-ext-buttons-1.10.16/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="codebook_tutorial_files/dt-ext-buttons-1.10.16/js/dataTables.buttons.min.js"></script><script src="codebook_tutorial_files/dt-ext-buttons-1.10.16/js/buttons.flash.min.js"></script><script src="codebook_tutorial_files/dt-ext-buttons-1.10.16/js/buttons.html5.min.js"></script><script src="codebook_tutorial_files/dt-ext-buttons-1.10.16/js/buttons.colVis.min.js"></script><script src="codebook_tutorial_files/dt-ext-buttons-1.10.16/js/buttons.print.min.js"></script><link href="codebook_tutorial_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="codebook_tutorial_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="codebook_tutorial_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="codebook_tutorial_files/selectize-0.12.0/selectize.min.js"></script><link href="codebook_tutorial_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="codebook_tutorial_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Codebook tutorial</h1>
                        <h4 class="author">Ruben Arslan</h4>
            
            <h4 class="date">2019-03-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rubenarslan/codebook/blob/master/vignettes/codebook_tutorial.Rmd"><code>vignettes/codebook_tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>codebook_tutorial.Rmd</code></div>

    </div>

    
    
<p>This is the practical part of a tutorial manuscript for this package, which you can find in full <a href="https://psyarxiv.com/5qc6h/">on PsyArXiv</a>.</p>
<p>Using the codebook package locally in RStudio</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">knit_by_pkgdown &lt;-<span class="st"> </span><span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NULL">is.null</a></span>(knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/get">get</a></span>(<span class="st">"fig.retina"</span>))</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="dt">warning =</span> <span class="ot">TRUE</span>, <span class="co"># show warnings during codebook generation</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="dt">message =</span> <span class="ot">TRUE</span>, <span class="co"># show messages during codebook generation</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="dt">error =</span> <span class="ot">TRUE</span>, <span class="co"># do not interrupt codebook generation in case of errors,</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">                <span class="co"># usually better for debugging</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="dt">echo =</span> <span class="ot">TRUE</span>  <span class="co"># show R code</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/theme_get">theme_set</a></span>(ggplot2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>())</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">pander<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/pander/topics/panderOptions">panderOptions</a></span>(<span class="st">"table.split.table"</span>, <span class="ot">Inf</span>)</a></code></pre></div>
<div id="loading-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-data" class="anchor"></a>Loading data</h2>
<p>It is time to load some data. In this Tutorial, I will walk you through the process by using the “bfi” dataset made available in the psych package (Goldberg, 1999; Revelle et al., 2016; Revelle, Wilt, &amp; Rosenthal, 2010). The bfi dataset is already very well documented in the psych R package, but using the codebook package, we can add automatically computed reliabilities, graphs, and machine-readable metadata to the mix. The dataset is available within R, but this will not usually be the case; I have therefore uploaded it to the OSF, which also features many other publicly available datasets. A new package in R, rio (Chan &amp; Leeper, 2018), makes loading data from websites in almost any format as easy as loading local data. You can import the dataset directly from the OSF1 by replacing the line</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(codebook)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">codebook_data &lt;-<span class="st"> </span>codebook<span class="op">::</span>bfi</a></code></pre></div>
<p>with</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">codebook_data &lt;-<span class="st"> </span>rio<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rio/topics/import">import</a></span>(<span class="st">"https://osf.io/s87kd/download"</span>, <span class="st">"csv"</span>)</a></code></pre></div>
<p>on line 34. R Markdown documents have to be reproducible and self-contained, so it is not enough for a dataset to be loaded locally; you must load the dataset at the beginning of the document. You can also use the document interactively, although this will not work seamlessly for the codebook package1. To see how this works, execute the line you just added by pressing Command + Enter (for a Mac) or Ctrl + Enter (for other platforms).</p>
<p>RStudio has a convenient data viewer you can use to check whether your command worked. In the environment tab on the top right, you should see “codebook_data”. Click that row to open a spreadsheet view of the dataset in RStudio. As you can see, it is not particularly informative. Just long columns of numbers with variable names like A4. Are we talking aggressiveness, agreeableness, or the German industrial norm for paper size? The lack of useful metadata is palpable. Click “Knit” again to see what the codebook package can do with this. This time, it will take longer. Once the result is shown in the viewer tab, scroll through it. You can see a few warnings stating that the package saw items that might form part of a scale, but there was no aggregated scale. You will also see graphs of the distribution for each item and summary statistics.</p>
</div>
<div id="adding-and-changing-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-and-changing-metadata" class="anchor"></a>Adding and changing metadata</h2>
<div id="variable-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#variable-labels" class="anchor"></a>Variable labels</h3>
<p>The last codebook you generated could already be useful if the variables had meaningful names and self-explanatory values. Unfortunately, this is rarely the case. Generally, you will need more metadata: labels for variables and values, a dataset description, and so on. The codebook package can use metadata that are stored in R attributes. Attributes in R are most commonly used to store the type of a variable; for instance, datetime in R is just a number with two attributes (a time zone and a class). However, they can just as easily store other metadata; the Hmisc (Harrell, 2018), haven (Wickham &amp; Miller, 2018), and rio (Chan &amp; Leeper, 2018) packages, for example, use attributes to store labels. The benefit of storing variable metadata in attributes is that even datasets that are the product of merging and processing raw data retain the necessary metadata. The haven and rio packages set these attributes when importing data from SPSS or Stata files. However, it is also easy to add metadata yourself:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attributes">attributes</a></span>(codebook_data<span class="op">$</span>C5)<span class="op">$</span>label &lt;-<span class="st"> "Waste my time."</span></a></code></pre></div>
<p>You have just assigned a new label to a variable. Because it is inconvenient to do this over and over again, the labelled package (Larmarange, 2018) adds a few convenience functions. Load the labelled package by writing the following in your codebook.Rmd</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(labelled)</a></code></pre></div>
<pre><code>## 
## LABELLED 2.0.0: BREAKING CHANGE
## 
## Following version 2.0.0 of `haven`, `labelled()` and `labelled_spss()` now produce objects with class 'haven_labelled' and 'haven_labelled_spss', due to conflict between the previous 'labelled' class and the 'labelled' class used by `Hmisc`.
## 
## A new function `update_labelled()` could be used to convert data imported with an older version of `haven`/`labelled` to the new classes.</code></pre>
<p>Now label the C5 item.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/labelled/topics/var_label">var_label</a></span>(codebook_data<span class="op">$</span>C5) &lt;-<span class="st"> "Waste my time."</span></a></code></pre></div>
<p>You can also label values in this manner (label in quotes before the equal sign, value after):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/labelled/topics/val_labels">val_labels</a></span>(codebook_data<span class="op">$</span>C1) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Very Inaccurate"</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">"Very Accurate"</span> =<span class="st"> </span><span class="dv">6</span>)</a></code></pre></div>
<p>Write these labelling commands after loading the dataset and click “Knit” again. As you can see in the viewer pane, the graph for the C1 variable now has a label at the top and the lowest and highest values on the X axis are labelled.1 If the prospect of adding labels for every single variable seems tedious, do not fear. Many researchers already have a codebook in the form of a spreadsheet that they want to import in order to avoid entering labels one-by-one. The bfi dataset in the psych package is a good example of this, because it comes with a tabular dictionary. On the line after loading the bfi data, type the following to import this data dictionary:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">dict &lt;-<span class="st"> </span>rio<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/rio/topics/import">import</a></span>(<span class="st">"https://osf.io/cs678/download"</span>, <span class="st">"csv"</span>)</a></code></pre></div>
<p>To see what you just loaded, click the “dict” row in the environment tab in the top right panel. As you can see, the dictionary has information on the constructs on which this item loads and on the direction with which it should load on the construct. You can make these metadata usable through the codebook package. You will often need to work on the data frames to help you do this; to make this easier, use the dplyr package (Wickham, François, Henry, &amp; Müller, 2018). Load it by typing the following</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a></code></pre></div>
<p>Your next goal is to use the variable labels that are already in the dictionary. Because you want to label many variables at once, you need a list of variable labels. Instead of assigning one label to one variable as you just did, you can assign many labels to the whole dataset from a named list. Here, each element of the list is one item that you want to label.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/labelled/topics/var_label">var_label</a></span>(codebook_data) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">        <span class="dt">C5 =</span> <span class="st">"Waste my time."</span>, </a>
<a class="sourceLine" id="cb11-3" data-line-number="3">        <span class="dt">C1 =</span> <span class="st">"Am exacting in my work."</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">)</a></code></pre></div>
<p>There are already a list of variables and labels in your data dictionary that you can use, so you do not have to perform the tedious task of writing out the list. You do have to reshape it slightly though, because it is currently in the form of a rectangular data frame, not a named list. To do so, use a convenience function from the codebook function called dict_to_list. This function expects to receive a data frame with two columns: the first should be the variable names, the second the variable labels. To select these columns, use the select function from the dplyr package. You will also need to use a special operator, called a pipe, which looks like this %&gt;% and allows you to read and write R code from left to right, almost like an English sentence. First, you need to take the dict dataset, then select the variable and label columns, then use the dict_to_list function. You also need to assign the result of this operation to become the variable labels of codebook_data. You can do all this in a single line using pipes. Add the following line after importing the dictionary.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/labelled/topics/var_label">var_label</a></span>(codebook_data) &lt;-<span class="st"> </span>dict <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(variable, label) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/list_to_dict.html">dict_to_list</a></span>()</a></code></pre></div>
<p>Click “codebook_data” in the Environment tab again. You should now see the variable labels below the variable names. If you click “Knit” again, you will see that your codebook now contains the variable labels. They are both part of the plots and part of the codebook table at the end. They are also part of the metadata that can be found using, for example, Google Dataset Search, but this will not be visible to you.</p>
</div>
<div id="value-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#value-labels" class="anchor"></a>Value labels</h3>
<p>So far, so good. But you may have noticed that education is shown as a number. Does this indicate years of education? The average is 3, so that seems unlikely. In fact, these numbers signify levels of education. In the dict data frame, you can see that there are are value labels for the levels of this variable. However, these levels of education are abbreviated, and you can probably imagine that it would be difficult for an automated program to understand how these map to the values in your dataset. You can do better, using another function from the labelled package: not var_label this time, but val_labels. Unlike var_label, val_labels expects not just one label, but a named vector1, with a name for each value that you want to label. You do not need to label all values. Named vectors are created using the c() function. Add the following lines right after the last one.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/labelled/topics/val_labels">val_labels</a></span>(codebook_data<span class="op">$</span>gender) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"male"</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">"female"</span> =<span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/labelled/topics/val_labels">val_labels</a></span>(codebook_data<span class="op">$</span>education) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"in high school"</span> =<span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">   <span class="st">"finished high school"</span> =<span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">              <span class="st">"some college"</span> =<span class="st"> </span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb13-5" data-line-number="5">               <span class="st">"college graduate"</span> =<span class="st"> </span><span class="dv">4</span>, </a>
<a class="sourceLine" id="cb13-6" data-line-number="6">              <span class="st">"graduate degree"</span> =<span class="st"> </span><span class="dv">5</span>)</a></code></pre></div>
<p>Click the “Knit” button. The bars in the graphs for education and gender should now be labelled. Now, on to the many Likert items, which all have the same value labels. You could assign them in the same way you did for gender and education, entering the lines for each variable over and over, or you could let a function do the job for you instead. Creating a function is actually very simple. Just pick a name, ideally one to remember it by—I chose add_likert_labels—and assign the keyword function followed by two different kinds of brackets. Round brackets surround the variable x. The x here is a placeholder for the many variables you will use this function for in the next step. Curly braces show that you intend to write out what you plan to do with the variable x. Inside the curly braces, use the val_labels function from above and assign a named vector.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">add_likert_labels &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/labelled/topics/val_labels">val_labels</a></span>(x) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Very Inaccurate"</span> =<span class="st"> </span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                  <span class="st">"Moderately Inaccurate"</span> =<span class="st"> </span><span class="dv">2</span>, </a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                  <span class="st">"Slightly Inaccurate"</span> =<span class="st"> </span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                  <span class="st">"Slightly Accurate"</span> =<span class="st"> </span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                  <span class="st">"Moderately Accurate"</span> =<span class="st"> </span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">                  <span class="st">"Very Accurate"</span> =<span class="st"> </span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">  x</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">}</a></code></pre></div>
<p>A function is just a tool and does nothing on its own; you have not used it yet. To use it only on the Likert items, you need a list of them. An easy way to achieve this is to subset the dict dataframe to only take those variables that are part of the Big Six. To do so, use the filter and pull functions from the dplyr package.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">likert_items &lt;-<span class="st"> </span>dict <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(Big6 <span class="op">!=</span><span class="st"> ""</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(variable)</a></code></pre></div>
<p>To apply your new function to these items, use another function from the dplyr package called mutate_at. It expects a list of variables and a function to apply to each. You have both! You can now add value labels to all Likert items in the codebook_data.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">codebook_data &lt;-<span class="st"> </span>codebook_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">mutate_at</a></span>(likert_items,  add_likert_labels)</a></code></pre></div>
<p>Click “Knit” again. All items should now have value labels. However, this display is quite repetitive. How about grouping the items by the factor that they are supposed to load on? And while you are at it, how can the metadata about keying (or reverse-coded items) in your dictionary become part of the dataset?</p>
</div>
<div id="adding-scales" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-scales" class="anchor"></a>Adding scales</h3>
<p>The codebook package relies on a simple convention to be able to summarise psychological scales, such as the Big Five dimension extraversion, which are aggregates across several items. Your next step will be to assign a new variable, extraversion, to the result of selecting all extraversion items in the data and passing them to the aggregate_and_document_scale function. This function takes the mean of its inputs and assigns a label to the result, so that you can still tell which variables it is an aggregate of.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">codebook_data<span class="op">$</span>extraversion &lt;-<span class="st"> </span>codebook_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(E1<span class="op">:</span>E5) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/aggregate_and_document_scale.html">aggregate_and_document_scale</a></span>()</a></code></pre></div>
<p>Try knitting now. In the resulting codebook, the items for extraversion have been grouped in one graph. In addition, several internal consistency coefficients have been calculated. However, they are oddly low. You need to reverse items which negatively load on the extraversion factor, such as “Don’t talk a lot.” To do so, I suggest following a simple convention early on, when you come up with names for your items—namely the format scale_numberR (e.g., bfi_extra_1R for a reverse-coded extraversion item, bfi_neuro_2 for a neuroticism item). That way, the analyst always knows how an item relates to a scale. This information is encoded in the data dictionary from the data you just imported. Rename the reverse-coded items so that you cannot forget about its direction. First, you need to grab all items with a negative keying from your dictionary. Add the following three lines above the aggregate_and_document_scale() line from above.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">reversed_items &lt;-<span class="st"> </span>dict <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(Keying <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(variable)</a></code></pre></div>
<p>You can see in your Environment tab that names such as A1, C4, and C5 are now stored in the reversed_items vector. You can now refer to this vector using the rename_at function, which applies a function to all variables you list. Use the very simple function add_R, which does exactly what its name indicates.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">codebook_data &lt;-<span class="st"> </span>codebook_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select_all.html">rename_at</a></span>(reversed_items,  add_R)</a></code></pre></div>
<p>Click “codebook_data” in the Environment tab and you will see that some variables have been renamed: A1R, C4R, and C5R, and so on. This could lead to an ambiguity: Does the suffix R means “should be reversed before aggregation” or “has already been reversed”? With the help of metadata in the form of labelled values, there is no potential for confusion. You can reverse the underlying values, but keep the value labels right. So, if somebody responded “Very accurate,” that remains the case, but the underlying value will switch from 6 to 1 for a reversed item. The data you generally import will rarely include labels that remain correct regardless of whether underlying values are reversed, but the codebook package makes it easy to bring the data into this shape. A command using dplyr functions and the reverse_labelled_values function can easily remedy this.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">codebook_data &lt;-<span class="st"> </span>codebook_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">mutate_at</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">matches</a></span>(<span class="st">"</span><span class="ch">\\</span><span class="st">dR$"</span>)), reverse_labelled_values)</a></code></pre></div>
All this statement does is find variable names which end with a number (
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#loading-data">Loading data</a></li>
      <li><a href="#adding-and-changing-metadata">Adding and changing metadata</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ruben Arslan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '0849aaec03e613204f45e1d6da8cff64',
    indexName: 'rubenarslan',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
